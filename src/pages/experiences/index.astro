---
import { getCollection } from "astro:content";
import BaseLayout from "../../layouts/BaseLayout.astro";
import Experiences from "../../components/Experiences.astro";

// filter out hidden entries and sort in descending order
const experiences = (await getCollection("experiences"))
    .filter((e) => e.data.is_visible)
    .map((e) => ({
        ...e,
        data: {
            ...e.data,
            roles: e.data.roles
                .filter((r) => r.is_visible)
                .sort((a, b) => b.order_id - a.order_id),
        },
    }))
    .sort((a, b) => b.data.order_id - a.data.order_id);
---

<BaseLayout slugOverride="experiences">
    <Experiences {experiences} />
</BaseLayout>
